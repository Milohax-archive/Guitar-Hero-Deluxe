#define FLARES
((Flare1 Flare3 Flare5 Flare7 Flare9 Flare11))
#define FLARE_UP
(0)
#define FLARE_DOWN
(180)
{arena load_section lighting lighting}
{func
   set_lights_bad
   {arena
      switch_anim
      orange_lights.envanim
      (loop 20000 25000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      pink_lights.envanim
      (loop 20000 25000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      red_lights.envanim
      (loop 20000 25000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      char_light01.litanim
      (loop 20000 25000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      char_light02.litanim
      (loop 20000 25000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      crowd_lighta.litanim
      (loop 20000 25000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      crowd_lightb.litanim
      (loop 20000 25000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      crowd_lighta1.litanim
      (loop 20000 25000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      crowd_lightb1.litanim
      (loop 20000 25000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      dry_ice1.partanim
      (range 0 0)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      dry_ice2.partanim
      (range 0 0)
      (scale 1)
      (blend 60)}}
{func
   set_lights_okay_verse
   {arena
      switch_anim
      orange_lights.envanim
      (loop 10000 15000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      pink_lights.envanim
      (loop 10000 15000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      red_lights.envanim
      (loop 10000 15000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      char_light01.litanim
      (loop 10000 15000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      char_light02.litanim
      (loop 10000 15000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      crowd_lighta.litanim
      (loop 10000 15000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      crowd_lightb.litanim
      (loop 10000 15000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      crowd_lighta1.litanim
      (loop 10000 15000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      crowd_lightb1.litanim
      (loop 10000 15000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      dry_ice1.partanim
      (range 0 0)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      dry_ice2.partanim
      (range 0 0)
      (scale 1)
      (blend 60)}}
{func
   set_lights_okay_chorus
   {arena
      switch_anim
      orange_lights.envanim
      (loop 40000 41920)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      pink_lights.envanim
      (loop 40000 41920)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      red_lights.envanim
      (loop 40000 41920)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      char_light01.litanim
      (loop 40000 41920)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      char_light02.litanim
      (loop 40000 41920)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      crowd_lighta.litanim
      (loop 40000 41920)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      crowd_lightb.litanim
      (loop 40000 41920)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      crowd_lighta1.litanim
      (loop 40000 41920)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      crowd_lightb1.litanim
      (loop 40000 41920)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      dry_ice1.partanim
      (range 0 0)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      dry_ice2.partanim
      (range 0 0)
      (scale 1)
      (blend 60)}}
{func
   set_lights_okay_solo
   {arena
      switch_anim
      orange_lights.envanim
      (loop 20000 25000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      pink_lights.envanim
      (loop 20000 25000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      red_lights.envanim
      (loop 20000 25000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      char_light01.litanim
      (loop 50000 55000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      char_light02.litanim
      (loop 50000 55000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      crowd_lighta.litanim
      (loop 20000 25000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      crowd_lightb.litanim
      (loop 20000 25000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      crowd_lighta1.litanim
      (loop 20000 25000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      crowd_lightb1.litanim
      (loop 20000 25000)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      dry_ice1.partanim
      (range 0 0)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      dry_ice2.partanim
      (range 0 0)
      (scale 1)
      (blend 60)}}
{func
   set_lights_great_verse
   {arena
      switch_anim
      orange_lights.envanim
      (loop 0 3840)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      pink_lights.envanim
      (loop 0 3840)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      red_lights.envanim
      (loop 0 3840)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      char_light01.litanim
      (loop 0 3840)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      char_light02.litanim
      (loop 0 3840)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      crowd_lighta.litanim
      (loop 0 3840)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      crowd_lightb.litanim
      (loop 0 3840)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      crowd_lighta1.litanim
      (loop 0 3840)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      crowd_lightb1.litanim
      (loop 0 3840)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      dry_ice1.partanim
      (range 1 1)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      dry_ice2.partanim
      (range 1 1)
      (scale 1)
      (blend 60)}}
{func
   set_lights_great_chorus
   {arena
      switch_anim
      orange_lights.envanim
      (loop 30000 31920)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      pink_lights.envanim
      (loop 30000 31920)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      red_lights.envanim
      (loop 30000 31920)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      char_light01.litanim
      (loop 30000 31920)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      char_light02.litanim
      (loop 30000 31920)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      crowd_lighta.litanim
      (loop 30000 31920)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      crowd_lightb.litanim
      (loop 30000 31920)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      crowd_lighta1.litanim
      (loop 30000 31920)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      crowd_lightb1.litanim
      (loop 30000 31920)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      dry_ice1.partanim
      (range 1 1)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      dry_ice2.partanim
      (range 1 1)
      (scale 1)
      (blend 60)}}
{func
   set_lights_great_solo
   {arena
      switch_anim
      orange_lights.envanim
      (loop 20000 25000)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      pink_lights.envanim
      (loop 20000 25000)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      red_lights.envanim
      (loop 20000 25000)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      char_light01.litanim
      (loop 50000 50000)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      char_light02.litanim
      (loop 50000 50000)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      crowd_lighta.litanim
      (loop 20000 25000)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      crowd_lightb.litanim
      (loop 20000 25000)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      crowd_lighta1.litanim
      (loop 20000 25000)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      crowd_lightb1.litanim
      (loop 20000 25000)
      (scale 2)
      (blend 60)}
   {arena
      switch_anim
      dry_ice1.partanim
      (range 1 1)
      (scale 1)
      (blend 60)}
   {arena
      switch_anim
      dry_ice2.partanim
      (range 1 1)
      (scale 1)
      (blend 60)}}
{func
   hit_speakers
   ($speakers)
   {foreach
      $anim
      $speakers
      {arena
         switch_anim
         $anim
         (range
            {random_int 110 130}
            0)
         (scale 1)
         (blend 0)}}}
{func
   hit_speakers_lite
   ($speakers)
   {foreach
      $anim
      $speakers
      {arena
         switch_anim
         $anim
         (range
            {random_int 25 45}
            0)
         (scale 1)
         (blend 0)}}}
{func
   hit_guitar_amp
   ($slot)
   {hit_speakers
      {switch
         $slot
         (0
            (tan_cone5.tnm tan_cone4.tnm))
         (1
            (tan_cone6.tnm tan_cone3.tnm))
         (2
            (tan_cone3.tnm tan_cone4.tnm))
         (3
            (tan_cone2.tnm tan_cone3.tnm tan_cone6.tnm))
         (4
            (tan_cone1.tnm tan_cone4.tnm tan_cone5.tnm))}}
   {switch
      $slot
      (0
         {hit_speakers_lite
            (tan_cone1.tnm tan_cone2.tnm tan_cone3.tnm tan_cone6.tnm)})
      (1
         {hit_speakers_lite
            (tan_cone1.tnm tan_cone2.tnm tan_cone4.tnm tan_cone5.tnm)})
      (2
         {hit_speakers_lite
            (tan_cone1.tnm tan_cone2.tnm tan_cone5.tnm tan_cone6.tnm)})
      (3
         {hit_speakers_lite
            (tan_cone1.tnm tan_cone4.tnm tan_cone5.tnm)})
      (4
         {hit_speakers_lite
            (tan_cone2.tnm tan_cone3.tnm tan_cone6.tnm)})}}
{arena
   add_handlers
   (finish_loading
      {"6 foot camera.cam"
         add_trans
         char_light03a.lit}
      {"6 foot camera.cam"
         add_trans
         color_plane.mesh}
      {cymbal_big.tnm unhook_anim_parents}
      {kickdrum01.tnm unhook_anim_parents}
      {cymbal_small.tnm unhook_anim_parents}
      {speaker1.tnm unhook_anim_parents}
      {speaker2.tnm unhook_anim_parents}
      {speaker3.tnm unhook_anim_parents}
      {speaker4.tnm unhook_anim_parents}
      {speaker5.tnm unhook_anim_parents}
      {speaker6.tnm unhook_anim_parents}
      {tan_cone1.tnm unhook_anim_parents}
      {tan_cone2.tnm unhook_anim_parents}
      {tan_cone3.tnm unhook_anim_parents}
      {tan_cone4.tnm unhook_anim_parents}
      {tan_cone5.tnm unhook_anim_parents}
      {tan_cone6.tnm unhook_anim_parents})
   (upcoming_drum_on
      {arena
         switch_anim
         cymbal_small.tnm
         (loop 0 100)
         (scale 1)
         (blend 240)})
   (upcoming_drum_off
      {arena
         switch_anim
         cymbal_small.tnm
         (range 0 0)
         (scale 1)
         (blend 240)})
   (intro_start
      {flare_obstruct.view set_showing TRUE}
      {venue.view remove_anim kickdrum01.tnm}
      {venue.view remove_anim cymbal_big.tnm}
      {cymbal_big.tnm set_frame 0}
      {crowd_lightc.litanim set_frame 0}
      {arena
         switch_anim
         dry_ice1.partanim
         (range 0 0)
         (scale 1)
         (blend 60)}
      {arena
         switch_anim
         dry_ice2.partanim
         (range 0 0)
         (scale 1)
         (blend 60)})
   (music_start
      {arena
         switch_anim
         cymbal_big.tnm
         (loop 0 100)
         (scale 5.0e-2)
         (blend 0)})
   (terminate
      {delete set_lights_bad}
      {delete set_lights_okay_verse}
      {delete set_lights_okay_chorus}
      {delete set_lights_okay_solo}
      {delete set_lights_great_verse}
      {delete set_lights_great_chorus}
      {delete set_lights_great_solo}
      {delete hit_guitar_amp}
      {delete hit_speakers}
      {delete hit_speakers_lite})
   (kick_drum
      {game anim_task kickdrum01.tnm 80 0 200})
   (bass_hit
      {hit_speakers
         (speaker1.tnm speaker2.tnm speaker3.tnm speaker4.tnm speaker5.tnm speaker6.tnm)})
   (hit_gem
      {hit_guitar_amp $slot})
   (excitement_bad)
   (excitement_okay)
   (excitement_great)
   (set_lights_bad
      {set_lights_bad})
   (set_lights_okay_verse
      {set_lights_okay_verse})
   (set_lights_okay_chorus
      {set_lights_okay_chorus})
   (set_lights_okay_solo
      {set_lights_okay_solo})
   (set_lights_great_verse
      {set_lights_great_verse})
   (set_lights_great_chorus
      {set_lights_great_chorus})
   (set_lights_great_solo
      {set_lights_great_solo})
   (game_won
      {arena
         switch_anim
         cymbal_big.tnm
         (range 0 0)
         (scale 1)
         (blend 1)}
      {arena
         switch_anim
         cymbal_small.tnm
         (range 0 0)
         (scale 1)
         (blend 1)})
   (game_lost
      {arena
         switch_anim
         cymbal_big.tnm
         (range 0 0)
         (scale 1)
         (blend 1)}
      {arena
         switch_anim
         cymbal_small.tnm
         (range 0 0)
         (scale 1)
         (blend 1)})
   (chorus
      {if
         {> $arena.excitement kExcitementBad}
         {foreach
            $flare
            FLARES
            {$flare set_steps FLARE_UP}}
         {flare_obstruct.view set_showing FALSE}
         {arena
            switch_anim
            crowd_lightc.litanim
            (range 50 100)
            (scale 1)
            (blend 60)}
         {arena
            delay_task
            960
            {foreach
               $flare
               FLARES
               {$flare set_steps FLARE_DOWN}}
            {flare_obstruct.view set_showing TRUE}
            {arena
               switch_anim
               crowd_lightc.litanim
               (range 0 49)
               (scale 1)
               (blend 120)}}})}